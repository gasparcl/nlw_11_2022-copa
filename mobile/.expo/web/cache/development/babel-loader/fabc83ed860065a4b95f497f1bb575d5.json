{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { createContext, useState, useEffect } from \"react\";\nimport * as Google from \"expo-auth-session/providers/google\";\nimport * as AuthSession from \"expo-auth-session\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext({});\nexport default function AuthContextProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState({}),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isUserLoading = _useState4[0],\n    setIsUserLoading = _useState4[1];\n  var _Google$useAuthReques = Google.useAuthRequest({\n      clientId: \"319754984878-dvg7pkgh3o1ouc26mhimqd8q4mdk4h75.apps.googleusercontent.com\",\n      redirectUri: AuthSession.makeRedirectUri({\n        useProxy: true\n      }),\n      scopes: [\"profile\", \"email\"]\n    }),\n    _Google$useAuthReques2 = _slicedToArray(_Google$useAuthReques, 3),\n    request = _Google$useAuthReques2[0],\n    response = _Google$useAuthReques2[1],\n    promptAsync = _Google$useAuthReques2[2];\n  function signIn() {\n    return _signIn.apply(this, arguments);\n  }\n  function _signIn() {\n    _signIn = _asyncToGenerator(function* () {\n      try {\n        setIsUserLoading(true);\n        yield promptAsync();\n      } catch (err) {\n        console.log(err);\n        throw err;\n      } finally {\n        setIsUserLoading(false);\n      }\n    });\n    return _signIn.apply(this, arguments);\n  }\n  function signInWithGoogle(_x) {\n    return _signInWithGoogle.apply(this, arguments);\n  }\n  function _signInWithGoogle() {\n    _signInWithGoogle = _asyncToGenerator(function* (accessToken) {});\n    return _signInWithGoogle.apply(this, arguments);\n  }\n  useEffect(function () {\n    var _response$authenticat;\n    if ((response == null ? void 0 : response.type) === \"success\" && (_response$authenticat = response.authentication) != null && _response$authenticat.accessToken) {\n      signInWithGoogle(response.authentication.accessToken);\n    }\n  }, [response]);\n  return _jsx(AuthContext.Provider, {\n    value: {\n      signIn: signIn,\n      isUserLoading: isUserLoading,\n      user: user\n    },\n    children: children\n  });\n}","map":{"version":3,"names":["createContext","useState","useEffect","Google","AuthSession","AuthContext","AuthContextProvider","children","user","setUser","isUserLoading","setIsUserLoading","useAuthRequest","clientId","redirectUri","makeRedirectUri","useProxy","scopes","request","response","promptAsync","signIn","err","console","log","signInWithGoogle","accessToken","type","authentication"],"sources":["/home/ecosis/cursos/nlw_11-2022_COPA/mobile/src/contexts/AuthContext.tsx"],"sourcesContent":["import { createContext, ReactNode, useState, useEffect } from \"react\"\nimport * as Google from \"expo-auth-session/providers/google\"\nimport * as AuthSession from \"expo-auth-session\"\nimport * as WebBrowser from \"expo-web-browser\"\n\ninterface UserProps {\n    name: string\n    avatartUrl: string\n}\n\nexport interface AuthContextDataProps {\n    user: UserProps\n    isUserLoading: boolean\n    signIn: () => Promise<void>\n}\n\nexport const AuthContext = createContext({} as AuthContextDataProps)\n\ninterface AuthProviderProps {\n    children: ReactNode\n}\n\nexport default function AuthContextProvider({ children }: AuthProviderProps) {\n    // ╦ ╦╔═╗╔═╗╦╔═╔═╗\n    // ╠═╣║ ║║ ║╠╩╗╚═╗\n    // ╩ ╩╚═╝╚═╝╩ ╩╚═╝\n    const [user, setUser] = useState<UserProps>({} as UserProps)\n    const [isUserLoading, setIsUserLoading] = useState(false)\n\n    const [request, response, promptAsync] = Google.useAuthRequest({\n        clientId:\n            \"319754984878-dvg7pkgh3o1ouc26mhimqd8q4mdk4h75.apps.googleusercontent.com\",\n        redirectUri: AuthSession.makeRedirectUri({ useProxy: true }),\n        scopes: [\"profile\", \"email\"],\n    })\n\n    async function signIn() {\n        try {\n            setIsUserLoading(true)\n            await promptAsync()\n        } catch (err) {\n            console.log(err)\n            throw err\n        } finally {\n            setIsUserLoading(false)\n        }\n    }\n\n    async function signInWithGoogle(accessToken: string) {}\n\n    useEffect(() => {\n        if (\n            response?.type === \"success\" &&\n            response.authentication?.accessToken\n        ) {\n            signInWithGoogle(response.authentication.accessToken)\n        }\n    }, [response])\n\n    return (\n        <AuthContext.Provider\n            value={{\n                signIn,\n                isUserLoading,\n                user,\n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    )\n}\n"],"mappings":";;AAAA,SAASA,aAAa,EAAaC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AACrE,OAAO,KAAKC,MAAM,MAAM,oCAAoC;AAC5D,OAAO,KAAKC,WAAW,MAAM,mBAAmB;AAAA;AAchD,OAAO,IAAMC,WAAW,GAAGL,aAAa,CAAC,CAAC,CAAC,CAAyB;AAMpE,eAAe,SAASM,mBAAmB,OAAkC;EAAA,IAA/BC,QAAQ,QAARA,QAAQ;EAIlD,gBAAwBN,QAAQ,CAAY,CAAC,CAAC,CAAc;IAAA;IAArDO,IAAI;IAAEC,OAAO;EACpB,iBAA0CR,QAAQ,CAAC,KAAK,CAAC;IAAA;IAAlDS,aAAa;IAAEC,gBAAgB;EAEtC,4BAAyCR,MAAM,CAACS,cAAc,CAAC;MAC3DC,QAAQ,EACJ,0EAA0E;MAC9EC,WAAW,EAAEV,WAAW,CAACW,eAAe,CAAC;QAAEC,QAAQ,EAAE;MAAK,CAAC,CAAC;MAC5DC,MAAM,EAAE,CAAC,SAAS,EAAE,OAAO;IAC/B,CAAC,CAAC;IAAA;IALKC,OAAO;IAAEC,QAAQ;IAAEC,WAAW;EAKnC,SAEaC,MAAM;IAAA;EAAA;EAAA;IAAA,4BAArB,aAAwB;MACpB,IAAI;QACAV,gBAAgB,CAAC,IAAI,CAAC;QACtB,MAAMS,WAAW,EAAE;MACvB,CAAC,CAAC,OAAOE,GAAG,EAAE;QACVC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;QAChB,MAAMA,GAAG;MACb,CAAC,SAAS;QACNX,gBAAgB,CAAC,KAAK,CAAC;MAC3B;IACJ,CAAC;IAAA;EAAA;EAAA,SAEcc,gBAAgB;IAAA;EAAA;EAAA;IAAA,sCAA/B,WAAgCC,WAAmB,EAAE,CAAC,CAAC;IAAA;EAAA;EAEvDxB,SAAS,CAAC,YAAM;IAAA;IACZ,IACI,CAAAiB,QAAQ,oBAARA,QAAQ,CAAEQ,IAAI,MAAK,SAAS,6BAC5BR,QAAQ,CAACS,cAAc,aAAvB,sBAAyBF,WAAW,EACtC;MACED,gBAAgB,CAACN,QAAQ,CAACS,cAAc,CAACF,WAAW,CAAC;IACzD;EACJ,CAAC,EAAE,CAACP,QAAQ,CAAC,CAAC;EAEd,OACI,KAAC,WAAW,CAAC,QAAQ;IACjB,KAAK,EAAE;MACHE,MAAM,EAANA,MAAM;MACNX,aAAa,EAAbA,aAAa;MACbF,IAAI,EAAJA;IACJ,CAAE;IAAA,UAEDD;EAAQ,EACU;AAE/B"},"metadata":{},"sourceType":"module"}